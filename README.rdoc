= Redmine Remote User auth plugin

With reverse proxy it can be used to use SSL certificate to login.
Plugin checks HTTP header Remote-User-Email. If user with such email
exists he/she will be logged in.

== Require

Redmine 2.x

== Installation

Before installing make sure to stop redmine.

1. <tt>cd [redmine-install-dir]/plugins</tt>
2. <tt>export RAILS_ENV=production</tt>
3. <tt>git clone git://XXXX</tt>
4. <tt>cd ..</tt>
5. <tt>rake redmine:plugins:migrate</tt>
6. <tt>bundle install --without development test</tt>

After this steps you can switch back on redmine. Existing users will gain 
Remote User auth method (Look at Administration > Users).

== Configuration


Reverse proxy must:

    * check certificate
    * unset Remote-User_email
    * header an set it to DN_Email from certificate

Apache example:


        SSLEngine on
        SSLProtocol all 
        SSLCipherSuite HIGH:MEDIUM

        SSLCertificateFile /etc/apache2/ssl/server.crt
        SSLCertificateKeyFile /etc/apache2/ssl/server.key
        SSLCACertificateFile /etc/apache2/ssl/ca.crt

        SetEnvIf User-Agent ".*MSIE.*" \
                nokeepalive ssl-unclean-shutdown \
                downgrade-1.0 force-response-1.0

        SSLVerifyClient optional
        SSLVerifyDepth 1
        SSLOptions +StdEnvVars

	RequestHeader unset Remote-User-Email
	RequestHeader add Remote-User-Email "%{SSL_CLIENT_S_DN_Email}e"
        
        SSLVerifyClient require


With valid certificate you can still log-in as users with normal Auth
Method.

== Uninstall

Before installing make sure to stop redmine and before that to disable 
Remote User auth method for all users (Look at Administration > Users)

1. <tt>cd [redmine-install-dir]</tt>
2. <tt>export RAILS_ENV=production</tt>
3. <tt>rake redmine:plugins:migrate NAME=redmine_remote_user_auth VERSION=0</tt>
4. <tt>rm -Rf plugins/redmine_cert_auth</tt>

After this steps you can switch back on redmine.
